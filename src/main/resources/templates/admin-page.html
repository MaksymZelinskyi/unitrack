<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Uni-Track</title>
    <th:block th:insert="fragments :: head"></th:block>
</head>
<body>

<div th:insert="fragments :: header"></div>

<div class="layout">

    <!-- MAIN SECTION -->
    <section class="main">
        <div class="header-row">
            <a class="stats-btn" th:href="@{/statistics}">
                View Stats
            </a>

            <h1 class="section-title centered">My Projects</h1>
        </div>

        <div class="project-grid-wrapper">

            <ul class="project-list four-columns">
                <!-- Left: Add Project button -->
                <a class="card add-project" th:href="@{/projects/new}">
                    <img src="/icons/plus.png" alt="Add Project"/>
                    <p>Add New Project</p>
                </a>
                <li th:each="project : ${projects}">
                    <a th:href="@{/projects/{id}(id=${project.id})}" class="project-card">
                        <div class="project-status"
                             th:classappend="|${project.status.toLowerCase()}|"></div>

                        <div class="project-content">
                            <div class="project-header">
                                <h4 class="project-title" th:text="${project.title}">Project Name</h4>
                                <span class="project-status-label" th:text="${project.status}">ACTIVE</span>
                            </div>

                            <p class="project-desc" th:text="${project.description}">Project description</p>

                            <div class="bottom">
                                <div class="project-meta">
                                    <span class="meta-label">Start time:</span>
                                    <span class="meta-value" th:text="${#temporals.format(project.start, 'dd MMM yyyy')}"></span>
                                </div>

                                <div class="project-meta">
                                    <span class="meta-label">Deadline:</span>
                                    <span class="meta-value" th:text="${#temporals.format(project.end, 'dd MMM yyyy')}"></span>
                                </div>

                                <div class="project-meta">
                                    <span class="meta-label">Client:</span>
                                    <span class="meta-value" th:text="${project.client.name}">Client</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </li>
            </ul>
        </div>
    </section>


    <!-- ASIDE SECTION -->
    <aside class="sidebar">

        <h1 class="section-title">My Team</h1>

        <!-- Add member -->
        <a class="collab-card add-collab" th:href="@{/collaborators/new}">
            <img src="/icons/plus.png" alt="Add Member"/>
            <p>Add New Member</p>
        </a>

        <ul class="vertical-list">
            <li th:each="collaborator : ${collaborators}" class="collab-card">

                <a th:href="@{/collaborators/{id}(id=${collaborator.id})}">
                    <div class="collab-info">
                        <img class="avatar" th:src="${#strings.isEmpty(collaborator.avatarUrl) ? '/icons/profile-icon.png' : collaborator.avatarUrl}"/>
                        <h4 class="collab-name" th:text="${collaborator.name}"></h4>
                    </div>

                </a>

                <!-- delete button -->
                <div class="collab-delete" th:if="${collaborator.id != currentUser.id}">
                    <form method="post" th:action="@{/collaborators/{id}(id=${collaborator.id})}">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit" class="confirm-delete">
                            <img src="/icons/trash.png" alt="Delete"/>
                        </button>
                    </form>
                </div>

            </li>
        </ul>

    </aside>
</div>

<div th:insert="fragments :: confirm-modal"></div>
<script src="/js/confirmation.js"></script>
</body>
</html>
