<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Uni-Track</title>
    <link rel="stylesheet" href="/styles/main.css" type="text/css"/>
</head>
<body>

<div th:insert="fragments :: header"></div>

<div class="layout">

    <!-- MAIN SECTION -->
    <section class="main">

        <a class="stats-btn" th:href="@{/statistics}">
            View Stats
        </a>

        <h1 class="section-title">My Projects</h1>
        <div class="project-grid-wrapper">
            <!-- Left: Add Project button -->
            <a class="card add-project" th:href="@{/projects/new}">
                <img src="https://www.pngarts.com/files/3/Plus-Symbol-Transparent-Images.png" alt="Add Project"/>
                <p>Add New Project</p>
            </a>

            <!-- Right: Project list in two columns -->
            <ul class="project-list two-columns">
                <li th:if="${projects == null || #lists.isEmpty(projects)}" class="empty-text">
                    No projects yet
                </li>

                <li th:each="project : ${projects}" class="project-card">
                    <div class="project-status done" th:if="${project.status == 'DONE'}"></div>
                    <div class="project-status planned" th:if="${project.status == 'PLANNED'}"></div>

                    <a th:href="@{/projects/{id}(id=${project.id})}">
                        <h4 class="project-title" th:text="${project.title}"></h4>
                        <p class="project-desc" th:text="${project.description}"></p>

                        <div class="project-meta">
                            <span class="meta-label">Deadline:</span>
                            <span th:text="${project.end}"></span>
                        </div>
                    </a>
                </li>
            </ul>
        </div>


    </section>


    <!-- ASIDE SECTION -->
    <aside class="sidebar">

        <h1 class="section-title">My Team</h1>

        <!-- Add member -->
        <a class="collab-card add-collab" th:href="@{/collaborators/new}">
            <img src="https://www.pngarts.com/files/3/Plus-Symbol-Transparent-Images.png" alt="Add Member"/>
            <p>Add New Member</p>
        </a>

        <ul class="collab-list">
            <li th:each="collaborator : ${collaborators}" class="collab-card">

                <a th:href="@{/collaborators/{id}(id=${collaborator.id})}">
                    <div class="collab-info">
                        <img class="avatar" th:src="${collaborator.avatarUrl}" alt="Profile Picture"/>
                        <h4 class="collab-name" th:text="${collaborator.name}"></h4>
                    </div>

                    <div class="collab-skills">
                        <span class="skills-label">Skills:</span>

                        <p th:if="${done == null || #lists.isEmpty(done)}" class="no-skill">None</p>

                        <div th:unless="${done == null || #lists.isEmpty(done)}" class="skills-container">
                            <span th:text="${#strings.substring(#strings.listJoin(collaborator.skills, ', '), 0, 15)}"></span>...

                            <details>
                                <summary class="show-more">more</summary>
                                <span th:text="${#strings.listJoin(collaborator.skills, ', ')}"></span>
                            </details>
                        </div>
                    </div>
                </a>

                <!-- delete button -->
                <div class="collab-delete" th:if="${collaborator.id != currentUser.id}">
                    <form method="post" th:action="@{/collaborators/{id}(id=${collaborator.id})}">
                        <input type="hidden" name="_method" value="delete"/>
                        <button type="submit">
                            <img src="https://www.pngmart.com/files/17/Waste-Garbage-Can-Vector-PNG-Clipart.png" alt="Delete"/>
                        </button>
                    </form>
                </div>

            </li>
        </ul>

    </aside>
</div>

</body>
</html>
